I"jQ<p>At the Dagstuhl seminar, <a href="http://web.cs.unlv.edu/stefika/">Andreas Stefik</a> asked me to speak about “Scientists Programming.” I’m not sure whether he did this on purpose, but by assigning people their talk titles, he drew us a little outside our comfort zone and got us to think more deeply. “Scientists Programming” wasn’t a talk that I had in my pocket, and wasn’t what I would have proposed, but it was fun to pull together. It made me realize that scientists programming is actually one of my primary interests, although I’ve never written that anywhere before. Felienne wrote up a <a href="http://www.felienne.com/archives/5900">nice summary</a> of my talk, but I wanted to write down some thoughts of my own.</p>

<!--more-->

<p><a class="thumb" href="https://www.flickr.com/photos/clement127/15236140202/in/photolist-pdncEs-rabMJr-qSKYvp-qPeSji-rmJJdW-btryhH-qK7VJj-cm1Hb-qdaYpW-fWAdZ-9WhgHt-oLa2TT-2vuJD-2vuKd-mk1ib-qAU7wq-r3voVM-8CAcWc-9oggZ-7w3hnt-56tdL-oLa3fV-2vuPq-2vuJ5-oLqNAT-otW1FH-hGxPy-9Gbfpi-kyh6Q-wL7Y9q-anxVft-otW5n1-bWGa2P-qmxh8-otWG7V-nCpBGK-oLa2C2-pqcggk-61RzgT-dgrA8g-gbGJp-nBBqqg-anxVyP-6KVaRB-anAxnS-anxJWP-oJoZ4d-rcEdVP-aySHmX-anxJdr"><img src="https://www.amelia.mn/img/ScientistsProgramming.png" class="img-responsive" alt="Female lego scientist" /></a></p>

<p>In the talk, I broke scientists’ programming tasks three categories:</p>

<ul>
  <li>making models to generate data</li>
  <li>generating data to make models</li>
  <li>application programming.</li>
</ul>

<p>That first category would include any scientist who has a theory about the world, and using modeling to try to represent some relationship, then runs the model to generate data. Once you have that data, you compare it to what you’ve seen in the real world to see how good your model is. I’ve seen this done in ecology with predator/prey relationships, but I’m pretty sure physicists, chemists, and many others use this same technique.</p>

<p>The second category is the one I think about the most, because it’s more statistical. In this paradigm, scientists generate data (through experimentation, surveying, observation, etc), and use those data to generate a model, which is likely statistical. Then, they assess how well the model does at representing the real world. I see these first two paradigms as two sides of the same coin.</p>

<p>The final category, application programming, is the one I know the least about. I know some scientists do things like program a Raspberry Pi to do some specific sensor activity, or program a robot to explore in a deep cave. However, I think that this category is usually in service of one of the above two (scientists are usually trying to observe something about the world). Since application programming is outside of my expertise, and I knew it would be the most familiar to the group at the Dagstuhl, I didn’t discuss this in my talk.</p>

<p>You can <a href="http://materials.dagstuhl.de/files/18/18061/18061.AmeliaA.McNamara1.Slides2.pdf">see my slides</a> if you want to know everything I covered, but the meat of the talk was digging into the paper by Julia Stewart Lowndes, et al, <a href="https://www.nature.com/articles/s41559-017-0160">“Our path to better science in less time using open data science tools”</a>. This paper is a perfect case study of a group of scientists who “We thought [they] were doing reproducible science” by using Excel, writing up their process, keeping versions of files by changing filenames, etc. But, they were able to transition to a more robust workflow using git/GitHub, R/RStudio, and RMarkdown. This has made them more accurate, and reduced the amount of time they spend on analysis.</p>

<p>To me, this is crucial. Science is the source of a lot of the “ground truth” we rely on as a society. It determines which treatments get used by doctors, what interventions we try on the environment, and just our general knowledge of how the world works. If science is wrong, there are big implications. One common example are <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1044-7">Excel errors in genomics research</a>.</p>

<p>I love that Lowndes’ group has made their code <a href="https://github.com/OHI-Science/">available on GitHub</a>. This is useful on so many levels</p>

<ul>
  <li>Anyone wanting to check their calculations can do so</li>
  <li>If you are a scientist, you can use it as a reference for coding</li>
  <li>Programming language designers can examine how scientists authentically code.</li>
</ul>

<p>In my talk, I showed some arbitrarily-chosen code from their repo to display how the tidyverse syntax makes code more human-readable.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">monitoring_indicator_mean_loc</span><span class="o">=</span><span class="w"> </span><span class="n">monitoring_indicator_mean</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
        </span><span class="n">left_join</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">coastal_fish_loc</span><span class="p">,</span><span class="w"> </span><span class="n">station_cleaned</span><span class="p">,</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">lon</span><span class="p">),</span><span class="w"> 
                                    </span><span class="n">by</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"monitoring_area"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"station_cleaned"</span><span class="p">))</span><span class="w">

</span><span class="n">coastal_fish_loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coastal_fish_loc</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">mutate</span><span class="p">(</span><span class="n">lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DECWGSN</span><span class="p">,</span><span class="w">
                           </span><span class="n">lon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DECWGSE</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">mutate</span><span class="p">(</span><span class="n">lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">station_cleaned</span><span class="o">==</span><span class="w"> </span><span class="s2">"ICES SD 31"</span><span class="p">,</span><span class="w"> </span><span class="m">64.207281</span><span class="p">,</span><span class="w">
                                 </span><span class="n">ifelse</span><span class="p">(</span><span class="n">station_cleaned</span><span class="o">==</span><span class="w"> </span><span class="s2">"ICES SD 30"</span><span class="p">,</span><span class="w"> </span><span class="m">61.679815</span><span class="p">,</span><span class="w">
                                 </span><span class="n">ifelse</span><span class="p">(</span><span class="n">station_cleaned</span><span class="o">==</span><span class="w"> </span><span class="s2">"ICES SD 29"</span><span class="p">,</span><span class="w"> </span><span class="m">59.705518</span><span class="p">,</span><span class="w">
                                 </span><span class="n">ifelse</span><span class="p">(</span><span class="n">station_cleaned</span><span class="o">==</span><span class="w"> </span><span class="s2">"ICES SD 32"</span><span class="p">,</span><span class="w"> </span><span class="m">60.108130</span><span class="p">,</span><span class="w">
                                 </span><span class="n">ifelse</span><span class="p">(</span><span class="n">station_cleaned</span><span class="o">==</span><span class="w"> </span><span class="s2">"Rectangle 23 &amp; 28"</span><span class="p">,</span><span class="w"> </span><span class="m">63.505817</span><span class="p">,</span><span class="w">
                                 		</span><span class="n">lat</span><span class="p">))))),</span><span class="w">
                           </span><span class="n">lon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">station_cleaned</span><span class="o">==</span><span class="w"> </span><span class="s2">"ICES SD 31"</span><span class="p">,</span><span class="w"> </span><span class="m">23.511161</span><span class="p">,</span><span class="w">
                                 </span><span class="n">ifelse</span><span class="p">(</span><span class="n">station_cleaned</span><span class="o">==</span><span class="w"> </span><span class="s2">"ICES SD 30"</span><span class="p">,</span><span class="w"> </span><span class="m">21.269112</span><span class="p">,</span><span class="w">
                                 </span><span class="n">ifelse</span><span class="p">(</span><span class="n">station_cleaned</span><span class="o">==</span><span class="w"> </span><span class="s2">"ICES SD 29"</span><span class="p">,</span><span class="w"> </span><span class="m">21.264879</span><span class="p">,</span><span class="w">
                                 </span><span class="n">ifelse</span><span class="p">(</span><span class="n">station_cleaned</span><span class="o">==</span><span class="w"> </span><span class="s2">"ICES SD 32"</span><span class="p">,</span><span class="w"> </span><span class="m">25.772410</span><span class="p">,</span><span class="w">
                                 </span><span class="n">ifelse</span><span class="p">(</span><span class="n">station_cleaned</span><span class="o">==</span><span class="w"> </span><span class="s2">"Rectangle 23 &amp; 28"</span><span class="p">,</span><span class="w"> </span><span class="m">21.351243</span><span class="p">,</span><span class="w"> 
                                 		</span><span class="n">lon</span><span class="p">))))))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                    </span><span class="n">mutate</span><span class="p">(</span><span class="n">station_cleaned</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">station_cleaned</span><span class="p">),</span><span class="w">
                           </span><span class="n">station</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">station</span><span class="p">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">temp_long</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coastal_fish_scores</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
            </span><span class="n">select</span><span class="p">(</span><span class="n">monitoring_area</span><span class="p">,</span><span class="n">core_indicator</span><span class="p">,</span><span class="n">taxa</span><span class="p">,</span><span class="w"> </span><span class="n">score1</span><span class="p">,</span><span class="n">score2</span><span class="p">,</span><span class="n">score3</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
            </span><span class="n">group_by</span><span class="p">(</span><span class="n">monitoring_area</span><span class="p">,</span><span class="w"> </span><span class="n">core_indicator</span><span class="p">,</span><span class="n">taxa</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
            </span><span class="n">gather</span><span class="p">(</span><span class="n">score_type</span><span class="p">,</span><span class="n">score</span><span class="p">,</span><span class="n">score1</span><span class="p">,</span><span class="n">score2</span><span class="p">,</span><span class="n">score3</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
            </span><span class="n">ungroup</span><span class="p">()</span><span class="w">

</span><span class="n">slope2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slope2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
        </span><span class="n">group_by</span><span class="p">(</span><span class="n">basin_name</span><span class="p">,</span><span class="w"> </span><span class="n">core_indicator</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
        </span><span class="n">mutate</span><span class="p">(</span><span class="n">slope_mean_basin_indicator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">slope_mean_basin_taxa</span><span class="p">))</span><span class="o">%&gt;%</span><span class="w">
        </span><span class="n">ungroup</span><span class="p">()</span><span class="w">

</span><span class="n">basin_n_obs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coastal_fish_scores_long</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
                            </span><span class="n">filter</span><span class="p">(</span><span class="n">score_type</span><span class="o">==</span><span class="s2">"score1"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
                            </span><span class="n">select</span><span class="p">(</span><span class="n">Basin_HOLAS</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
                            </span><span class="n">count</span><span class="p">(</span><span class="n">Basin_HOLAS</span><span class="p">)</span></code></pre></figure>

<p>Interestingly, the programming language designers found this code hard to read and confusing. Although I’ve heard computer scientists complain about R many times before, I wasn’t anticipating this. I thought that the piped sequence of function calls would be pretty readable. Maybe it was the <code class="language-plaintext highlighter-rouge">%&gt;%</code> for the pipe rather than <code class="language-plaintext highlighter-rouge">|</code>, or maybe they would have preferred to see it as separate steps.</p>

<p>I wish I had shown this example, taken from Garrett Grolemund’s Master the Tidyverse materials (which I also showed in my <a href="https://github.com/AmeliaMN/IntroToR">Intro to R &amp; RStudio</a> workshop).</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">arrange</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">babynames</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2015</span><span class="p">,</span><span class="w"> 
  </span><span class="n">sex</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"M"</span><span class="p">),</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">desc</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">boys_2015</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">babynames</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2015</span><span class="p">,</span><span class="w"> </span><span class="n">sex</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"M"</span><span class="p">)</span><span class="w">
</span><span class="n">boys_2015</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">boys_2015</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w">
</span><span class="n">boys_2015</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">arrange</span><span class="p">(</span><span class="n">boys_2015</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="w">
</span><span class="n">boys_2015</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">babynames</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2015</span><span class="p">,</span><span class="w"> </span><span class="n">sex</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"M"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></code></pre></figure>

<p>I think with this comparison, it’s easier to see why the piped approach is better for people. With the nested function calls, you have to do a lot of checking in your head to make sure the parentheses are matched, and it’s hard to follow the logic. The incremental approach is good, but you type the name of the data many times. In the last example, the data flows through the piped sequence in a clearer way.</p>

<p>One question that came up in my talk was “if we fixed the problems with R as a language, would you appreciate that?” and I didn’t have a great answer. As a user, I (and I believe most scientists) don’t feel the language issues that frustrate computer scientists. It just works for what I need to do. In fact, my talk introduced yet another idea that we came back to again and again– some people who use programming languages don’t think of themselves as programmers. I know many people who use R, but consider it a tool to do data analysis rather than something to program in.</p>

<p>I think the thing I exposed people to that they were most excited about was RMarkdown. While it seemed most people were familiar with the idea of iPython/Jupyter notebooks, they hadn’t seen knitr before. The idea that they could create a fully reproducible journal article interweaving text and code was very appealling. I showed a simple example with HTML output including text, code, and code output, but over the next few days I demoed more complex (Rnw) examples from my own work that produce publication-ready documents. For example, <a href="https://github.com/COSTDataExpo2013/AmeliaMN/blob/master/PaperFinalDraft.pdf">this pdf of a paper for Computational Statistics</a> was generated from <a href="https://github.com/COSTDataExpo2013/AmeliaMN/blob/master/PaperFinalDraft.Rnw">this LaTeX/knitr file</a>. While this group of computer scientists work on experiments surrounding programming language design, and therefore do the same types of data analytic tasks as many scientists, they didn’t have this piece of their workflow.</p>

:ET